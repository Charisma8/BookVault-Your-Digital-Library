<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BookVault: Your Digital Library</title>
  <style>
    body, html {
      height: 100%;
      margin: 0;
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: url('https://chicandkiddo.com/cdn/shop/files/1-PA020-dark-academy-vintage-wallpaper.jpg?v=1727988893&width=2500') no-repeat center center fixed;
      background-size: cover;
      overflow-x: hidden;
      color: #f0f0f0;
    }
    body::before {
      content: "";
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(15, 25, 35, 0.75);
      backdrop-filter: blur(8px);
      z-index: -1;
    }
    .container {
      max-width: 800px;
      background: rgba(74, 73, 73, 0.1);
      border-radius: 20px;
      margin: 50px auto;
      padding: 30px 40px;
      box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.18);
    }
    h1, h2 {
      color: #cde4ff;
      font-weight: 700;
      text-align: center;
      text-shadow: 1px 1px 6px rgba(0,0,0,0.8);
      margin-bottom: 25px;
    }
    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 10px;
    }
    thead th {
      color: #ffffff;
      text-align: left;
      padding: 12px 15px;
      font-weight: 600;
      text-transform: uppercase;
      font-size: 0.9rem;
      letter-spacing: 1.3px;
      background: transparent;
      border-bottom: 2px solid rgba(209, 213, 219, 0.3);
    }
    tbody tr {
      background: rgba(255, 255, 255, 0.12);
      border-radius: 15px;
      box-shadow: 0 6px 9px rgba(0, 0, 0, 0.15);
      transition: transform 0.3s ease, box-shadow 0.3s ease;
      cursor: default;
    }
    tbody tr:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(0, 0, 0, 0.3);
      background: rgba(198, 14, 14, 0.25);
    }
    tbody td {
      padding: 15px;
      color: #e0e7ff;
      vertical-align: middle;
    }
    form {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin-top: 30px;
    }
    form input[type="text"], form input[type="number"] {
      padding: 14px 20px;
      border-radius: 30px;
      border: 1.5px solid rgba(255,255,255,0.3);
      background: rgba(187, 15, 15, 0.12);
      color: #064df2;
      width: 220px;
      outline: none;
      transition: border-color 0.3s ease, box-shadow 0.3s ease;
      box-shadow: 0 2px 6px rgba(0,0,0,0.07);
      font-weight: 500;
    }
    form input[type="text"]:focus,
    form input[type="number"]:focus {
      border-color: #97caff;
      box-shadow: 0 0 10px #97caff;
      background: rgba(255, 255, 255, 0.2);
    }
    button.add-btn {
      background: linear-gradient(45deg, #031743, #4ca4ff);
      border: none;
      padding: 14px 35px;
      font-size: 18px;
      border-radius: 35px;
      font-weight: 700;
      color: white;
      cursor: pointer;
      box-shadow: 0 4px 14px rgba(58, 137, 255, 0.6);
      transition: background 0.3s ease, box-shadow 0.3s ease;
      min-width: 150px;
    }
    button.add-btn:hover {
      background: linear-gradient(45deg, #1b6de8, #3d92ff);
      box-shadow: 0 6px 24px rgba(50, 128, 255, 0.8);
    }
    button.delete-btn {
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 0;
      display: flex;
      align-items: center;
    }
    button.delete-btn img {
      width: 24px;
      height: 24px;
      filter: drop-shadow(0 0 2px rgba(255,0,0,0.7));
      transition: transform 0.3s ease;
    }
    button.delete-btn:hover img {
      transform: scale(1.2);
      filter: drop-shadow(0 0 3px rgba(255,0,0,0.9));
    }
    @media (max-width: 600px) {
      form input[type="text"], form input[type="number"] {
        width: 100%;
      }
      form {
        flex-direction: column;
        align-items: stretch;
      }
      button.add-btn {
        width: 100%;
        min-width: auto;
      }
    }
  </style>
</head>
<body>
  <div class="container" role="main" aria-label="Book List Application">
    <h1>BookVault: Your Digital Library</h1>

    <h2>Registered Books</h2>
    <table aria-label="List of Books">
      <thead>
        <tr>
          <th>ID</th><th>Title</th><th>Author</th><th>Price (₹)</th><th>Actions</th>
        </tr>
      </thead>
      <tbody id="bookTableBody"></tbody>
    </table>

    <h2>Add a New Book</h2>
    <form id="addBookForm" aria-label="Add book form">
      <input type="text" id="title" placeholder="Book Title" required aria-required="true" />
      <input type="text" id="author" placeholder="Author Name" required aria-required="true" />
      <input type="number" id="price" placeholder="Price in ₹" step="0.01" min="0" required aria-required="true" />
      <button type="submit" class="add-btn">Add Book</button>
    </form>
  </div>

  <script>
    function loadBooks() {
      fetch('http://localhost:5000/books')
        .then(res => res.json())
        .then(data => {
          const tbody = document.getElementById('bookTableBody');
          tbody.innerHTML = '';
          data.forEach(book => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${book.book_id}</td>
              <td>${book.title}</td>
              <td>${book.author}</td>
              <td>${parseFloat(book.price).toFixed(2)}</td>
              <td>
                <button class="delete-btn" onclick="deleteBook(${book.book_id})" aria-label="Delete book ${book.title}">
                  <img src="https://img.icons8.com/material-outlined/24/ff0000/trash--v1.png" alt="Delete" />
                </button>
              </td>
            `;
            tbody.appendChild(tr);
          });
        })
        .catch(() => alert('Failed to load books. Please check backend server.'));
    }

    document.getElementById('addBookForm').onsubmit = function(e) {
      e.preventDefault();
      const title = this.title.value.trim();
      const author = this.author.value.trim();
      const price = parseFloat(this.price.value);

      if (!title || !author || isNaN(price) || price < 0) {
        alert('Please enter valid book details');
        return;
      }

      fetch('http://localhost:5000/books', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({title, author, price})
      })
      .then(res => res.json())
      .then(data => {
        alert(data.message);
        this.reset();
        loadBooks();
      })
      .catch(() => alert('Failed to add book. Check backend server.'));
    };

    function deleteBook(bookId) {
      if (!confirm('Are you sure you want to delete this book?')) return;

      fetch(`http://localhost:5000/books/${bookId}`, {method: 'DELETE'})
        .then(res => res.json())
        .then(data => {
          alert(data.message);
          loadBooks();
        })
        .catch(() => alert('Failed to delete book.'));
    }

    loadBooks();
  </script>
</body>
</html>
